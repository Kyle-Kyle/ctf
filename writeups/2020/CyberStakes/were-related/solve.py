#!/usr/bin/env python2

from __future__ import print_function

import binascii

from pwn import *

n = 27607181346013830729177284887939356716222828873207125661601723895320362970647047547219526423409390082642386604683385000602817163383821976918928284014105987401614862431837215798914594399761070594339941056964035988333614149177576256407639955414210046388281622359875360181382847153865439484081184012046769264419216122103860197910941752961915383598012613257787952538710995791614723882907931290465484850197183654625460255077707494174998315828857018481731061240797541378157880606978824480150401199153996445207228487684415653273726315905420295655900863579952611810813862184604558680084775761797027831631147651130620872798651
e = 65537

flag = 23804416249848769440566080622679931413989189199479638980063514662517485135275518979068421801339336611860700123312581988547612524869556070580988195515600116053865556804956539452691436220013627661702042186022899355041316750252257601610594661521828015240760971452669429181094499325186110921432659601403412107983799479633530838853519837649143275852944401501299238611806706723570977654227582113145099860167562049437135249667440712211314563360892674809715250919276262391384650568611316315942213150998073973638274713625716212435276835691150658921331444627993536196036614972509058858286489913705948633080016044426716393122354

c_prime = (flag * 2**e) % n


def main():
    context.log_level = 'debug'
    io = remote('challenge.acictf.com', 55372)
    io.sendlineafter('\n', 'RECV:' + str(c_prime))

    p_prime = int(io.recvline().strip())
    pt = (p_prime / 2) % n

    hex_pt = hex(pt)[2:].rstrip('L')
    print(binascii.unhexlify(hex_pt))


if __name__ == '__main__':
    main()