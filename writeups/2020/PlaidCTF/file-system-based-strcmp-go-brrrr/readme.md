# file system based strcmp go brrrr

The name of this challenge directed me towards a project that was on [Hacker News](https://news.ycombinator.com/) recently: [regex2fat](https://github.com/8051Enthusiast/regex2fat). This project converts a regex to a DFA, and then encodes that DFA into a graph of directory entries in a FAT32 file system. Directory structures in a FAT32 file system can kind of be thought of as lookup tables to other addresses in the disk image. Those addresses might point to other directory trees or files. Since the "children" of a directory is just a series of addresses, these addresses can cyclicly point to other directories that already exist in the file system. A regex encoded in this file system will then match a string if the directory sequence representing that string exists.

Knowing that this challenge involves a `strcmp` operation, we can assume the same rule applies: string comparisons will be determined based on the path that we take through the file system. However, now the success condition is marked by the presence of a `MATCH` file in the last directory of the traversal. Normally, the solution would be quite simple: start at a `MATCH` file and walk up the parent directories until we hit a path that starts with the flag format. Unfortunately, this disk image does not contain any '..' entries within its directory entries, so there is no way to resolve a parent directory only from a child.

[My solution script](./solve.py) solves this issue by walking all directory entries in the disk image, mapping directories to the disk image address that they point to as well as the address of the parent directory that contains them. This allows us to backtrack from a `MATCH` file up through the graph, constructing the flag from the names of the directories that we traverse. Most of the FAT32 parsing code comes from [this gist](https://gist.github.com/jonte/4577833), which was a great resource.

Looking at some other writeups, it looks like the `find` utility is actually smart enough to not follow the cyclic directories and can find the flag much faster than how long it took to implement this solution. Oh well, still learned a lot about FAT32.

The file is too large to upload to this repository, but the original link to it is [here](https://play.plaidctf.com/files/strcmp-6114c4cc30e112b0c94028d9c8a07f5cd1d59723bc00cf3f992bec039825ea5c.tar.gz).
